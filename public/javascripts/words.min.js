/*! Copyright zmjdc.com 2014-04-30 */
(function() {
    z.Words = function() {
        function e() {}
        return e.prototype.handleVotes = function(e, b) {
            var $ele = $(b), q, $parent = e.delegateElement;
            e.preventDefault();
            if (!z.user.isauth()) {
                z.message("error", z.i18n.text("need_auth"));
                return false;
            }
            q = z.util.objectQuery($ele.attr("href"));
            $.extend(q, {
                nuid: Cookies.get("nuid_"),
                suid: Cookies.get("suid_")
            });
            $.ajax("/api/rate", {
                type: "GET",
                data: q,
                complete: function(d, s) {
                    if (s !== "success") {
                        z.message("error", "something wrong, try again");
                        return false;
                    }
                    var _d = JSON.parse(d.response_text), _c, _e;
                    if (_d.error_code) {
                        z.message("error", _d.error_msg);
                        return false;
                    }
                    _c = _d.response_body - 0;
                    if (_c === 0) {
                        _e = q.a;
                        if (_e === 1) {
                            var _f = $("count", $ele), _g;
                            _g = _f.text() - 0;
                            _f.text(_g++);
                        }
                    }
                }
            });
        }, e;
    }.call(this), $(function() {
        return z.words = new z.Words(), $(".votes").on("click", ".vote-anchor", function(e) {
            return z.words.handleVotes(e, this);
        });
    });
}).call(this);